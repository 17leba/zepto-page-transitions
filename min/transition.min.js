$(document).ready(function(){$(document.body).transition().show()});
(function(b){var l=0,s=!1;window.location.href.slice(0,window.location.href.lastIndexOf("/")+1);var m=null,p={},t=window.location.href,e=null,u={},q=[],r={options:function(a){m=b.extend({defaultPageTransition:"fade",domCache:!1},a)},init:function(a,c,f){s||(s=!0,b(document.body).transition("options",{}),b(window).on("hashchange",function(){var a=e||b(document.body);if(!u[window.location.hash]){var c=window.location.hash;e&&e.is("form")&&(c={type:e.attr("method")||"get",url:window.location.hash.slice(1),
data:e.serialize(),dataType:"html",global:!1});a.transition("changePage",c,null==e)}e=null}));var d=b('div[data-role="page"]',this);d.length||(this.is("div")?(this.attr("data-role","page"),this.attr("id","_trans_div"+l),d=this):(d=b('<div data-role="page" id="_trans_div'+l+'" />'),this.children().wrapAll(d)));a&&d.trigger("pageload",a);if(window.location.hash){a=d.first().attr("id");var h;h=(p[window.location.hash]||window.location.hash.slice(1)).replace(/[:\.\+\/]/g,"_");d.first().attr("id",h);a&&
(b('[data-href="#'+a+'"]',d).attr("data-href","#"+h),b('[href="#'+a+'"]',d).attr("href","#"+h))}d.attr("style","position: absolute; width: 100%; height: 100%; left: 0px; top: 0px;");d.each(function(){b(this).attr("id")||b(this).attr("id","_trans_div"+l);p["#"+b(this).attr("id")]=t;b(this).css("zIndex",l++)});b("a[href]",d).not("[target]").not('[rel="external"]').not('[data-ajax="false"]').not("[data-href]").transition("hijackLinks");b("[data-href]",d).transition("hijackLinks");b("form").not("[target]").not('[data-ajax="false"]').transition("hijackLinks");
f||(f=document.title);d.not("[data-title]").data("title",f);d.hide();c=(c=c?b(c):null)||d.first();c.addClass("ui-page-active");d.trigger("pageinit");return c},hijackLinks:function(){return this.each(function(){var a=b(this);if("back"==a.data("rel")){var c=function(a){window.history.back();a.preventDefault()};a.on("click",c);a.on("tap",c)}else{var f=a.attr("data-href")||a.attr("href")||a.attr("action")||"#";if("#"===f.charAt(0)){if(b('a[name="'+f.slice(1)+'"]').length){u[f]=!0;return}}else f="#"+f,
a.is("a")?a.attr("href",f):a.attr("action")&&a.attr("action",f),a.attr("data-href")&&a.attr("data-href",f);a.is("a")?c=function(){e=a}:a.is("form")?(c=function(b){e=a;window.location.href=f;b.preventDefault()},a.on("submit",c)):c=function(){e=a;window.location.href=f};a.is("form")||(a.on("click",c),a.on("tap",c))}})},changePage:function(a,c){var f={toPage:a,back:c},d=b.Event("pagebeforechange");b(this).trigger(d,f);if(!d.defaultPrevented){a=f.toPage;c=f.back;var h=null;if(c&&q.length)h=q.pop().transition;
else if(h=b(this).attr("transition")||b(this).data("transition")||m.defaultPageTransition,!c&&(q.push({href:window.location.pathname,transition:h}),"reverse"===(b(this).attr("direction")||b(this).data("direction"))))c=!0;var d="string"===typeof a?a:a.url,g=null,v=b("div.ui-page-active"),e=!1;if("string"===typeof a&&"#"===a.charAt(0)){var k=b(a.replace(/[:\.\+\/]/g,"_"));k.length?(b(this).transition("perform",v,k,h,c,f),e=!0):!m.domCache&&p[a]?(g=a,a=p[a]):a=a.slice(1)}if(!e){var j={href:d,element:b(this),
back:c},d=b.Event("pagebeforeload");b(this).trigger(d,j);var n=b(this);d.defaultPrevented||(b(this).transition("load",a,j,function(a,d,e){d=b("<div />");d.html(a);b(document.body).append(d);a=b(d).transition("init",j,g,e);b(n).transition("perform",v,a,h,c,f)}),e=!0)}e||b(this).trigger("pagechangefailed",f)}},load:function(a,c,f){a="string"===typeof a?{url:a,dataType:"html",global:!1}:a;a.url||(a.url=window.location.href);a.success=function(d,h,g){c.xhr=g;c.textStatus=h;t=a.url;m.domCache||b('div[data-role="page"]').not('[data-dom-cache="true"]').addClass("transition-recyclable");
g=d.search(/<body/i);var e=d;h=d;var l;-1!=g&&(e=d.slice(0,g),g=d.indexOf(">",g),bodyEnd=d.search(/<\/body>/i),h=d.slice(g+1,bodyEnd));(g=e.match(/<title>(.+)<\/title>/im))&&(l=g[1]);if(window.location.hash){g=window.location.pathname;var k=window.location.hash.slice(1),e="",j=k.lastIndexOf("/");if(-1!=j&&(e=k.slice(0,j+1),"/"==e.charAt(0))){"/"==!g.charAt(0)&&(g="/"+g);j=k=1;do j=e.indexOf("/",j)+1,j>k&&e.slice(0,j)==g.slice(0,j)&&(k=j);while(0<j&&j==k);var n="",j=k;do j=g.indexOf("/",j+1),-1!=j&&
(n+="../");while(-1!=j);e=n+e.slice(k)}g=e;g.length&&(h=h.replace(/(\b(src|href|action))="([^"#:]+)"/gi,'$1="'+g+'$3"'),h=h.replace(/(\b(src|href|action))="(.+\/)?[^\/]+\/\.\.\//gi,'$1="$3'))}f(h,d,l)};a.error=function(d,e,f){c.xhr=d;c.textStatus=e;c.errorThrown=f;b(this).trigger("pageloadfailed",c);b(this).trigger("pagechangefailed",{toPage:a.url})};b.ajax(a)},perform:function(a,c,e,d,h){a.trigger("pagebeforehide",a);c.trigger("pagebeforeshow",c);window.setTimeout(function(){a.addClass(e+" out");
a.removeClass("ui-page-active");c.show();c.addClass(e+" in");c.addClass("ui-page-active");d&&(a.addClass("reverse"),c.addClass("reverse"))},1);window.setTimeout(function(){a.removeClass(e+" out");c.removeClass(e+" in");a.removeClass("reverse");c.removeClass("reverse");var d=c.data("title");d&&(document.title=d);a.trigger("pagehide",a);c.trigger("pageshow",c);b(this).trigger("pagechange",h);b('div[data-role="page"]').hide();c.show();m.domCache||(b("div.transition-recyclable").each(function(){var a=
b.Event("pageremove");b(this).trigger(a,b(this));a.defaultPrevented||b(this).remove()}),b("div").not("[id]").not(function(){return b(this).children().length}).remove())},707)}};b.fn.transition=function(a){if(r[a])return r[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof a||!a)return r.init.apply(this,arguments);throw"Method "+a+" does not exist";}})(Zepto);
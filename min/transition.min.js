$(document).ready(function(){$(document.body).transition().show()});
(function(b){var i=0,l=!1;window.location.href.slice(0,window.location.href.lastIndexOf("/")+1);var k=null,m={},p=window.location.href,e=null,q={},n=[],j={options:function(a){k=b.extend({defaultPageTransition:"fade",domCache:!1},a)},init:function(a,c,f){l||(l=!0,b(document.body).transition("options",{}),b(window).on("hashchange",function(){var a=e||b(document.body);if(!q[window.location.hash]){var c=window.location.hash;e&&e.is("form")&&(c={type:e.attr("method")||"get",url:window.location.hash.slice(1),
data:e.serialize(),dataType:"html",global:!1});a.transition("changePage",c,null==e)}e=null}));var d=b('div[data-role="page"]',this);d.length||(this.is("div")?(this.attr("data-role","page"),this.attr("id","_trans_div"+i),d=this):(d=b('<div data-role="page" id="_trans_div'+i+'" />'),this.children().wrapAll(d)));a&&d.trigger("pageload",a);if(window.location.hash){var a=d.first().attr("id"),h;h=(m[window.location.hash]||window.location.hash.slice(1)).replace(/[:\.\+\/]/g,"_");d.first().attr("id",h);a&&
(b('[data-href="#'+a+'"]',d).attr("data-href","#"+h),b('[href="#'+a+'"]',d).attr("href","#"+h))}d.attr("style","position: absolute; width: 100%; height: 100%; left: 0px; top: 0px;");d.each(function(){b(this).attr("id")||b(this).attr("id","_trans_div"+i);m["#"+b(this).attr("id")]=p;b(this).css("zIndex",i++)});b("a[href]",d).not("[target]").not('[rel="external"]').not('[data-ajax="false"]').not("[data-href]").transition("hijackLinks");b("[data-href]",d).transition("hijackLinks");b("form").not("[target]").not('[data-ajax="false"]').transition("hijackLinks");
f||(f=document.title);d.not("[data-title]").data("title",f);d.hide();c=(c=c?b(c):null)||d.first();c.addClass("ui-page-active");d.trigger("pageinit");return c},hijackLinks:function(){return this.each(function(){var a=b(this);if("back"==a.data("rel")){var c=function(a){window.history.back();a.preventDefault()};a.on("click",c);a.on("tap",c)}else{var f=a.attr("data-href")||a.attr("href")||a.attr("action")||"#";if("#"===f.charAt(0)){if(b('a[name="'+f.slice(1)+'"]').length){q[f]=!0;return}}else f="#"+f,
a.is("a")?a.attr("href",f):a.attr("action")&&a.attr("action",f),a.attr("data-href")&&a.attr("data-href",f);a.is("a")?c=function(){e=a}:a.is("form")?(c=function(b){e=a;window.location.href=f;b.preventDefault()},a.on("submit",c)):c=function(){e=a;window.location.href=f};a.is("form")||(a.on("click",c),a.on("tap",c))}})},changePage:function(a,c){var f={toPage:a,back:c},d=b.Event("pagebeforechange");b(this).trigger(d,f);if(!d.defaultPrevented){var a=f.toPage,c=f.back,h=null;if(c&&n.length)h=n.pop().transition;
else if(h=b(this).attr("transition")||b(this).data("transition")||k.defaultPageTransition,!c&&(n.push({href:window.location.pathname,transition:h}),"reverse"===(b(this).attr("direction")||b(this).data("direction"))))c=!0;var d="string"===typeof a?a:a.url,g=null,r=b("div.ui-page-active"),e=!1;if("string"===typeof a&&"#"===a.charAt(0)){var i=b(a.replace(/[:\.\+\/]/g,"_"));i.length?(b(this).transition("perform",r,i,h,c,f),e=!0):!k.domCache&&m[a]?(g=a,a=m[a]):a=a.slice(1)}if(!e){var j={href:d,element:b(this),
back:c},d=b.Event("pagebeforeload");b(this).trigger(d,j);var l=b(this);d.defaultPrevented||(b(this).transition("load",a,j,function(a,d,e){d=b("<div />");d.html(a);b(document.body).append(d);a=b(d).transition("init",j,g,e);b(l).transition("perform",r,a,h,c,f)}),e=!0)}e||b(this).trigger("pagechangefailed",f)}},load:function(a,c,f){a="string"===typeof a?{url:a,dataType:"html",global:!1}:a;a.url||(a.url=window.location.href);a.success=function(d,h,g){c.xhr=g;c.textStatus=h;p=a.url;k.domCache||b('div[data-role="page"]').not('[data-dom-cache="true"]').addClass("transition-recyclable");
var g=d.search(/<body/i),e=d,h=d,i;-1!=g&&(e=d.slice(0,g),g=d.indexOf(">",g),bodyEnd=d.search(/<\/body>/i),h=d.slice(g+1,bodyEnd));(g=e.match(/<title>(.+)<\/title>/im))&&(i=g[1]);if(window.location.hash&&(g=window.location.hash.lastIndexOf("/"),-1!=g)){e=window.location.hash.slice(1,g+1);h=h.replace(/(\b(src|href|action))="([^"#:]+)"/gi,'$1="'+e+'$3"');do var g=e.lastIndexOf("/",g-2)+1,j='(\\b(src|href|action))="'+e.slice(g)+"../",e=e.slice(0,g),h=h.replace(RegExp(j,"gi"),'$1="');while(0<g)}f(h,d,
i)};a.error=function(d,f,e){c.xhr=d;c.textStatus=f;c.errorThrown=e;b(this).trigger("pageloadfailed",c);b(this).trigger("pagechangefailed",{toPage:a.url})};b.ajax(a)},perform:function(a,c,f,d,e){a.trigger("pagebeforehide",a);c.trigger("pagebeforeshow",c);window.setTimeout(function(){a.addClass(f+" out");a.removeClass("ui-page-active");c.show();c.addClass(f+" in");c.addClass("ui-page-active");d&&(a.addClass("reverse"),c.addClass("reverse"))},1);window.setTimeout(function(){a.removeClass(f+" out");c.removeClass(f+
" in");a.removeClass("reverse");c.removeClass("reverse");var d=c.data("title");d&&(document.title=d);a.trigger("pagehide",a);c.trigger("pageshow",c);b(this).trigger("pagechange",e);b('div[data-role="page"]').hide();c.show();k.domCache||(b("div.transition-recyclable").each(function(){var a=b.Event("pageremove");b(this).trigger(a,b(this));a.defaultPrevented||b(this).remove()}),b("div").not("[id]").not(function(){return b(this).children().length}).remove())},707)}};b.fn.transition=function(a){if(j[a])return j[a].apply(this,
Array.prototype.slice.call(arguments,1));if("object"===typeof a||!a)return j.init.apply(this,arguments);b.error("Method "+a+" does not exist")}})(Zepto);